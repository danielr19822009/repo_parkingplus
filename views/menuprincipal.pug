extends layout

block main
    .home-container
        h1 Menú de Gestión de Parqueaderos
        p Selecciona una opción para continuar.

        .menu-container
            nav.nav-menu
              
                a.btn-nav(href="/crearparqueadero") Crear Parqueadero
                a.btn-nav(href="/parqueaderos/reportes") Reportes de Parqueaderos
                a.btn-nav(href="/") Volver al Inicio

        // ==========================
        // LISTADO DE PARQUEADEROS CREADOS (FORMATO TABLA)
        // ==========================
        if parqueaderos && parqueaderos.length > 0
            h2 Lista de Parqueaderos Registrados

            table.table-lista
                thead
                    tr
                        th Nombre
                        th Dirección
                        th Capacidad
                        th Acciones

                tbody
                    each p in parqueaderos
                        tr
                            td #{p.nombre}
                            td #{p.direccion}
                            td #{p.capacidad}
                            td
                                a.btn-accion(href=`/parqueaderos/${p._id}`) Ver
                                a.btn-accion(href=`/parqueaderos/editar/${p._id}`) Editar
                                
                               
        else
            p.no-data No hay parqueaderos registrados todavía.
            

    // script para mostrar los parqueaderos registrados
    script.
        document.addEventListener("DOMContentLoaded", async () => {
            try {
                const response = await fetch("/parqueadero");
                const result = await response.json();
                const data = result.data;

                if (Array.isArray(data) && data.length > 0) {
                    const noData = document.querySelector(".no-data");
                    if (noData) noData.remove();

                    const h2 = document.createElement("h2");
                    h2.textContent = "Lista de Parqueaderos Registrados";

                    const table = document.createElement("table");
                    table.className = "table-lista";

                    table.innerHTML = `
                        <thead>
                            <tr>
                                <th>Nombre</th>
                                <th>Dirección</th>
                                <th>Capacidad</th>
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody></tbody>
                    `;

                    data.forEach(p => {
                        const tr = document.createElement("tr");
                        tr.innerHTML = `
                            <td>${p.nombreparqueadero}</td>
                            <td>${p.direccion}</td>
                            <td>${p.capacidad}</td>
                           
                            <td>
                                <a class="btn-accion" href="/parqueaderos/${p._id}">Ver</a>
                                <a class="btn-accion" href="/parqueaderos/editar/${p._id}">Editar</a>
                            </td>
                        `;
                        table.querySelector("tbody").appendChild(tr);
                    });

                    const container = document.querySelector(".home-container");
                    container.appendChild(h2);
                    container.appendChild(table);
                }
            } catch (error) {
                console.error("Error cargando Parqueaderos:", error);
            }
        });
